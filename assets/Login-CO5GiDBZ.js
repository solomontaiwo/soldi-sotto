import{r as n,u as I,x as S,a as P,b as M,j as e,m as D,B as h,$ as O,a0 as U,a1 as z,a2 as A,a3 as B,a4 as T,a5 as q,a6 as H,a7 as R,L as p,M as b,N as f}from"./index-DVNr0Sae.js";import{L as w,I as j}from"./label-DmEWnETg.js";const $=()=>{const[o,N]=n.useState(""),[c,v]=n.useState(""),[i,y]=n.useState(!1),[E,l]=n.useState(!1),[u,d]=n.useState(""),m=I(),k=S(),F=P({maxWidth:768}),{t:s}=M(),g=t=>t.includes("@")&&t.includes("."),L=async t=>{try{const a=await p(b(f,"usernames",t.toLowerCase()));if(a.exists()){const r=a.data().uid,x=await p(b(f,"users",r));if(x.exists())return x.data().email}return null}catch(a){return console.error("Errore nella ricerca username:",a),null}},C=async t=>{t.preventDefault(),l(!0),d("");try{let a=o;if(!g(o)){const r=await L(o);if(!r){d(s("errors.usernameNotFound")),l(!1);return}a=r}await H(R,a,c),k.success(s("login.title")),m("/dashboard")}catch(a){console.error(s("errors.loginError"),a);let r=s("errors.loginError");switch(a.code){case"auth/user-not-found":r=g(o)?s("errors.emailNotFound"):s("errors.usernameNotFound");break;case"auth/wrong-password":r=s("errors.wrongPassword");break;case"auth/invalid-email":r=s("errors.invalidEmail");break;case"auth/too-many-requests":r=s("errors.tooManyRequests");break;case"auth/invalid-credential":r=s("errors.invalidCredentials");break;default:r=a.message}d(r)}finally{l(!1)}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center px-4 py-10 bg-background",children:[e.jsx("div",{className:"absolute inset-0 -z-10 bg-gradient-to-br from-primary/10 via-emerald-500/5 to-transparent"}),e.jsxs(D.div,{initial:{opacity:0,y:16},animate:{opacity:1,y:0},className:"w-full max-w-md rounded-2xl border border-border bg-card/80 p-6 shadow-2xl backdrop-blur-xl",children:[e.jsxs(h,{variant:"ghost",size:"sm",onClick:()=>m("/"),className:"mb-4 gap-2 text-muted-foreground",children:[e.jsx(O,{className:"h-4 w-4"}),s("login.backToHome")]}),e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"flex h-11 w-11 items-center justify-center rounded-xl bg-primary/10 text-primary text-2xl",children:"ðŸ’°"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold",children:s("login.title")}),e.jsx("p",{className:"text-muted-foreground text-sm",children:s("login.subtitle")})]})]}),u&&e.jsx("div",{className:"mb-4 rounded-lg border border-destructive/40 bg-destructive/10 p-3 text-sm text-destructive",children:u}),e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"loginInput",children:s("login.usernameOrEmail")}),e.jsxs("div",{className:"flex items-center gap-2 rounded-lg border border-input bg-background px-3 focus-within:ring-2 focus-within:ring-ring",children:[e.jsx(U,{className:"text-muted-foreground"}),e.jsx(j,{id:"loginInput",type:"text",placeholder:s("login.usernameOrEmailPlaceholder"),value:o,onChange:t=>N(t.target.value),className:"border-0 shadow-none focus-visible:ring-0",autoComplete:"username"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:s("login.usernameOrEmailHelp")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(w,{htmlFor:"password",children:s("login.password")}),e.jsxs("div",{className:"flex items-center gap-2 rounded-lg border border-input bg-background px-3 focus-within:ring-2 focus-within:ring-ring",children:[e.jsx(z,{className:"text-muted-foreground"}),e.jsx(j,{id:"password",type:i?"text":"password",placeholder:s("login.passwordPlaceholder"),value:c,onChange:t=>v(t.target.value),className:"border-0 shadow-none focus-visible:ring-0",autoComplete:"current-password"}),e.jsx("button",{type:"button",onClick:()=>y(!i),className:"text-muted-foreground",children:i?e.jsx(A,{}):e.jsx(B,{})})]})]}),e.jsxs(h,{type:"submit",className:"w-full gap-2",size:F?"default":"lg",disabled:E,children:[e.jsx(T,{className:"h-4 w-4"}),s("login.loginButton")]})]}),e.jsxs("div",{className:"mt-4 text-center text-sm text-muted-foreground",children:[s("login.noAccount")," ",e.jsx(q,{to:"/register",className:"font-semibold text-primary",children:s("login.registerNow")})]})]})]})};export{$ as default};
