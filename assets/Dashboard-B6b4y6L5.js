import{P as r,u as R,a as S,b as A,j as e,B as y,F as E,c as I,d as q,R as M,e as P,f as z,r as v,g as k,h as B,i as L,k as Q}from"./index-DbSxnKd7.js";import{T as U}from"./TransactionModal-CkEp_t9B.js";import{C as p,a as j,b as u,c as g,d as f}from"./card-BtzA1eOl.js";import{f as d}from"./formatCurrency-DQxE0pTn.js";import{S as b}from"./endOfWeek-CaI494tH.js";import{g as $,c as _}from"./statsUtils-CRjRBkvC.js";import"./categories-Bt8gM9tX.js";import"./label-IlEHHpAK.js";import"./differenceInDays-CrAOT0Vj.js";const F=({transactions:c=[],loading:w=!1})=>{F.propTypes={transactions:r.arrayOf(r.shape({id:r.string.isRequired,description:r.string.isRequired,amount:r.number.isRequired,type:r.oneOf(["income","expense"]).isRequired,date:r.object.isRequired,category:r.string})),loading:r.bool};const l=R(),o=S({maxWidth:768}),{t:n}=A(),N=[...c].sort((s,i)=>{const m=s.date?.toDate?s.date.toDate():new Date(s.date);return(i.date?.toDate?i.date.toDate():new Date(i.date)).getTime()-m.getTime()}).slice(0,5),T=s=>(s.toDate?s.toDate():new Date(s)).toLocaleDateString("it-IT",{day:"2-digit",month:"2-digit",year:"numeric"}),x=s=>s==="income"?e.jsx(I,{className:"text-emerald-600"}):e.jsx(q,{className:"text-rose-600"}),t=s=>s?n("categories."+s)||s:"";return w?e.jsx("div",{className:"space-y-3",children:[...Array(5)].map((s,i)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(b,{circle:!0,width:40,height:40}),e.jsxs("div",{className:"flex-1",children:[e.jsx(b,{height:16,width:120}),e.jsx(b,{height:12,width:80})]}),e.jsx(b,{height:18,width:60})]},i))}):N.length===0?e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"text-4xl",children:"ðŸ“‹"}),e.jsx("p",{className:"text-muted-foreground",children:n("recentTransactions.emptyDescription")}),e.jsx(y,{onClick:()=>l("/transactions"),size:o?"sm":"default",children:n("recentTransactions.addFirst")})]}):e.jsxs("div",{className:"space-y-3",children:[N.map(s=>e.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-border bg-card/70 p-3 shadow-sm",onClick:()=>l("/transactions"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`flex h-10 w-10 items-center justify-center rounded-full ${s.type==="income"?"bg-emerald-500/10":"bg-rose-500/10"}`,children:x(s.type)}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-semibold text-sm",children:s.description}),e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx("span",{children:T(s.date)}),s.category&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"â€¢"}),e.jsx("span",{className:"capitalize",children:t(s.category)})]})]})]})]}),e.jsxs("div",{className:`text-sm font-semibold ${s.type==="income"?"text-emerald-600":"text-rose-600"}`,children:[s.type==="income"?"+":"-",d(s.amount)]})]},s.id)),e.jsx("div",{className:"flex justify-end",children:e.jsxs(y,{variant:"ghost",size:"sm",onClick:()=>l("/transactions"),className:"gap-1 text-primary",children:[n("recentTransactions.viewAll"),e.jsx(E,{className:"h-4 w-4"})]})})]})},H=()=>{const c=R(),{currentUser:w}=P(),{transactions:l,isDemo:o,canAddMoreTransactions:n,loading:N}=z(),[T,x]=v.useState(!1),{t}=A(),s=v.useMemo(()=>{const a=localStorage.getItem("analytics-period");if(a)try{return JSON.parse(a)}catch{return{period:"monthly"}}return{period:"monthly"}},[]),{start:i,end:m}=$(s.period||"monthly",s.customRange),D=v.useMemo(()=>l.filter(a=>{const C=a.date?.toDate?a.date.toDate():new Date(a.date);return C>=i&&C<=m}),[l,i,m]),h=D.length?_(D,i,m):{totalIncome:0,totalExpense:0,balance:0},O=v.useMemo(()=>[{key:"add-transaction",title:t("addTransaction"),subtitle:t("whatToRegister"),icon:e.jsx(k,{}),action:()=>x(!0),disabled:o&&!n},{key:"view-transactions",title:t("manageAll"),subtitle:t("yourTransactions"),icon:e.jsx(B,{}),action:()=>c("/transactions")},{key:"view-analytics",title:t("navbar.analytics"),subtitle:t("landing.mainFeatures"),icon:e.jsx(L,{}),action:()=>c("/analytics")}],[o,n,c,t]);return e.jsxs("div",{className:"page-shell",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between rounded-2xl border border-border bg-card/70 p-5",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Soldi Sotto"}),e.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:["ðŸ‘‹"," ",t("welcome")]}),e.jsx("p",{className:"text-sm text-muted-foreground max-w-2xl",children:t("motivationalQuote")})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 md:gap-3",children:[e.jsxs(y,{variant:"outline",size:"lg",onClick:()=>c("/analytics"),className:"gap-2 px-4",children:[e.jsx(Q,{className:"h-4 w-4"}),t("navbar.analytics")]}),e.jsxs(y,{size:"lg",onClick:()=>x(!0),disabled:o&&!n,className:"gap-2 px-4",children:[e.jsx(k,{className:"h-4 w-4"})," ",t("addTransaction")]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(p,{className:"glass",children:[e.jsxs(j,{children:[e.jsx(u,{children:t("financialOverview.balance")}),e.jsx(g,{children:t("financialOverview.totalTransactions")})]}),e.jsxs(f,{children:[e.jsx("p",{className:"text-3xl font-bold text-primary",children:d(h.balance||0)}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[t("financialOverview.totalIncome"),": ",d(h.totalIncome||0)]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[t("financialOverview.totalExpense"),": ",d(h.totalExpense||0)]})]})]}),e.jsxs(p,{className:"glass",children:[e.jsxs(j,{children:[e.jsx(u,{children:t("financialOverview.totalIncome")}),e.jsx(g,{children:s.period})]}),e.jsxs(f,{children:[e.jsx("p",{className:"text-3xl font-bold text-emerald-600",children:d(h.totalIncome||0)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t("recentTransactions.title")})]})]}),e.jsxs(p,{className:"glass",children:[e.jsxs(j,{children:[e.jsx(u,{children:t("financialOverview.totalExpense")}),e.jsx(g,{children:s.period})]}),e.jsxs(f,{children:[e.jsx("p",{className:"text-3xl font-bold text-rose-600",children:d(h.totalExpense||0)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t("recentTransactions.title")})]})]})]}),e.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[e.jsxs(p,{className:"lg:col-span-2 glass",children:[e.jsxs(j,{children:[e.jsx(u,{children:t("quickActions")}),e.jsx(g,{children:t("whatToRegister")})]}),e.jsx(f,{className:"grid gap-3 md:grid-cols-3",children:O.map(a=>e.jsxs("button",{onClick:()=>!a.disabled&&a.action(),className:`flex items-center gap-3 rounded-xl border border-border bg-card/80 p-4 text-left shadow-sm transition hover:-translate-y-1 hover:shadow-lg ${a.disabled?"opacity-60 cursor-not-allowed":""}`,children:[e.jsx("span",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-primary/10 text-primary",children:a.icon}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:a.title}),e.jsx("div",{className:"text-xs text-muted-foreground",children:a.subtitle})]})]},a.key))})]}),e.jsxs(p,{className:"glass",children:[e.jsxs(j,{children:[e.jsx(u,{children:t("recentTransactions.title")}),e.jsx(g,{children:t("recentTransactions.viewAll")})]}),e.jsx(f,{children:e.jsx(F,{transactions:l,loading:N})})]})]}),e.jsx(U,{show:T,onClose:()=>x(!1),transaction:null})]})},se=M.memo(H);export{se as default};
