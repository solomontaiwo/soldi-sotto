import{r as i,b as R,E as C,d as F,e as T,j as e,m as l,f as u,av as I,Z as A,aw as P,ax as H,ay as U,an as B,az as D,aA as M,aB as O,p as y,q as j,s as v}from"./index-Dfnw6OGv.js";import{A as W}from"./Alert-BfIOCwvu.js";import{F as o}from"./Form-BPhr4Ilg.js";import"./hook-DkxLrfC1.js";import"./Col-ED-jduSG.js";import"./useEventCallback-BVlm4tEg.js";const V=()=>{const[n,w]=i.useState(""),[p,N]=i.useState(""),[d,k]=i.useState(!1),[S,c]=i.useState(!1),[x,m]=i.useState(""),g=R(),E=C(),b=F({maxWidth:768}),{t:r}=T(),h=a=>a.includes("@")&&a.includes("."),L=async a=>{try{const t=await y(j(v,"usernames",a.toLowerCase()));if(t.exists()){const s=t.data().uid,f=await y(j(v,"users",s));if(f.exists())return f.data().email}return null}catch(t){return console.error("Errore nella ricerca username:",t),null}},z=async a=>{a.preventDefault(),c(!0),m("");try{let t=n;if(!h(n)){const s=await L(n);if(!s){m("Username non trovato"),c(!1);return}t=s}await M(O,t,p),E.success("Accesso effettuato con successo!"),g("/dashboard")}catch(t){console.error("Errore durante il login:",t);let s="Errore durante l'accesso";switch(t.code){case"auth/user-not-found":s=h(n)?"Email non trovata":"Username non trovato";break;case"auth/wrong-password":s="Password non corretta";break;case"auth/invalid-email":s="Email non valida";break;case"auth/too-many-requests":s="Troppi tentativi. Riprova piÃ¹ tardi";break;case"auth/invalid-credential":s="Credenziali non valide";break;default:s=t.message}m(s)}finally{c(!1)}};return e.jsx("div",{className:"min-vh-100 d-flex align-items-center justify-content-center",style:{background:"var(--background-primary, #f8fafc)",padding:b?"8px":"24px",position:"relative"},children:e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},style:{width:"100%",maxWidth:"370px",position:"relative"},children:[e.jsx(l.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.1},className:"mb-3",children:e.jsxs(u,{variant:"link",onClick:()=>g("/"),className:"text-decoration-none p-0 d-flex align-items-center gap-2",style:{fontSize:"13px",background:"rgba(255,255,255,0.18)",borderRadius:"10px",padding:"6px 14px",border:"1px solid rgba(0,0,0,0.07)",color:"#222",backdropFilter:"blur(8px)",transition:"all 0.2s ease"},onMouseEnter:a=>{a.currentTarget.style.background="rgba(0,0,0,0.08)"},onMouseLeave:a=>{a.currentTarget.style.background="rgba(255,255,255,0.18)"},children:[e.jsx(I,{size:15}),r("login.backToHome")]})}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.72)",borderRadius:"18px",border:"1px solid rgba(0,0,0,0.06)",boxShadow:"0 2px 16px rgba(0,0,0,0.06)",padding:b?"16px":"22px",position:"relative",backdropFilter:"blur(12px)",willChange:"transform"},children:[e.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"text-center mb-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center gap-2 mb-2",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center",style:{width:"38px",height:"38px",background:"rgba(13,110,253,0.13)",color:"#0d6efd",fontSize:"18px"},children:"ðŸ’°"}),e.jsxs("div",{className:"text-start",children:[e.jsx("h2",{className:"fw-semibold text-dark mb-0",style:{fontSize:"1.25rem"},children:r("login.title")}),e.jsx("small",{className:"text-muted",style:{fontSize:"0.95rem"},children:r("login.subtitle")})]})]})}),x&&e.jsx(l.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"mb-3",children:e.jsx(W,{variant:"danger",className:"border-0",style:{background:"rgba(239, 68, 68, 0.08)",borderRadius:"10px",border:"1px solid rgba(239, 68, 68, 0.13)",padding:"8px 12px"},children:e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("span",{children:"âŒ"}),e.jsx("span",{style:{fontSize:"14px"},children:x})]})})}),e.jsxs(o,{onSubmit:z,autoComplete:"on",children:[e.jsxs(o.Group,{className:"mb-3",controlId:"loginInput",children:[e.jsx(o.Label,{className:"fw-semibold small",children:r("login.usernameOrEmail")}),e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text bg-transparent border-end-0",style:{padding:"0.5rem 0.7rem",fontSize:"1.1rem",color:document.documentElement.classList.contains("dark-theme")?"#fff":"#222"},children:e.jsx(A,{})}),e.jsx(o.Control,{type:"text",placeholder:r("login.usernameOrEmailPlaceholder"),value:n,onChange:a=>w(a.target.value),style:{background:"rgba(255,255,255,0.7)",border:"1px solid #e5e7eb",borderRadius:"10px",borderTopLeftRadius:0,borderBottomLeftRadius:0,fontSize:"1rem",minHeight:"44px",padding:"0.5rem 1rem",color:"#222",boxShadow:"none"},autoComplete:"username"})]}),e.jsx(o.Text,{className:"text-muted small",children:r("login.usernameOrEmailHelp")})]}),e.jsxs(o.Group,{className:"mb-3",controlId:"password",children:[e.jsx(o.Label,{className:"fw-semibold small",children:r("login.password")}),e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text bg-transparent border-end-0",style:{padding:"0.5rem 0.7rem",fontSize:"1.1rem",color:document.documentElement.classList.contains("dark-theme")?"#fff":"#222"},children:e.jsx(P,{})}),e.jsx(o.Control,{type:d?"text":"password",placeholder:r("login.passwordPlaceholder"),value:p,onChange:a=>N(a.target.value),style:{background:"rgba(255,255,255,0.7)",border:"1px solid #e5e7eb",borderRadius:"10px",borderTopLeftRadius:0,borderBottomLeftRadius:0,fontSize:"1rem",minHeight:"44px",padding:"0.5rem 1rem",color:"#222",boxShadow:"none"},autoComplete:"current-password"}),e.jsx(u,{variant:"outline-secondary",onClick:()=>k(!d),style:{border:"none",background:"transparent",color:"#888",fontSize:"1.1rem",borderRadius:"0 10px 10px 0",minHeight:"44px"},tabIndex:-1,children:d?e.jsx(H,{}):e.jsx(U,{})})]})]}),e.jsxs(u,{type:"submit",className:"w-100 fw-semibold mt-2",style:{borderRadius:"10px",minHeight:"44px",fontSize:"1.08rem",background:"rgba(13,110,253,0.93)",color:"#fff",border:"none",boxShadow:"0 1px 6px rgba(13,110,253,0.07)",transition:"all 0.2s"},disabled:S,children:[e.jsx(B,{className:"me-2"})," ",r("login.loginButton")]})]}),e.jsxs("div",{className:"text-center mt-3",children:[e.jsx("span",{className:"text-muted small",children:r("login.noAccount")})," ",e.jsx(D,{to:"/register",className:"fw-semibold",style:{color:"#0d6efd",textDecoration:"none"},children:r("login.registerNow")})]})]})]})})};export{V as default};
