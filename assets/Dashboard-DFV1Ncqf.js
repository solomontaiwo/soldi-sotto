import{P as l,u as S,a as M,b as O,j as e,B as k,F as q,c as P,d as z,R as B,e as $,f as L,r as m,g as A,h as Q,i as U,k as _}from"./index-DssBxwp5.js";import{T as H}from"./TransactionModal-wPIxqLBv.js";import{C as f,a as N,b as v,c as y,d as b}from"./card-BNvv_Wep.js";import{S as i,f as j,g as J,c as W}from"./statsUtils-5rr_oV2s.js";import"./categories-Myjl_15-.js";import"./label-BrbFPq4j.js";const E=({transactions:h=[],loading:g=!1})=>{E.propTypes={transactions:l.arrayOf(l.shape({id:l.string.isRequired,description:l.string.isRequired,amount:l.number.isRequired,type:l.oneOf(["income","expense"]).isRequired,date:l.object.isRequired,category:l.string})),loading:l.bool};const o=S(),x=M({maxWidth:768}),{t:c}=O(),r=[...h].sort((s,n)=>{const t=s.date?.toDate?s.date.toDate():new Date(s.date);return(n.date?.toDate?n.date.toDate():new Date(n.date)).getTime()-t.getTime()}).slice(0,5),w=s=>(s.toDate?s.toDate():new Date(s)).toLocaleDateString("it-IT",{day:"2-digit",month:"2-digit",year:"numeric"}),F=s=>s==="income"?e.jsx(P,{className:"text-emerald-600"}):e.jsx(z,{className:"text-rose-600"}),p=s=>s?c("categories."+s)||s:"";return g?e.jsx("div",{className:"space-y-3",children:[...Array(5)].map((s,n)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(i,{circle:!0,width:40,height:40}),e.jsxs("div",{className:"flex-1",children:[e.jsx(i,{height:16,width:120}),e.jsx(i,{height:12,width:80})]}),e.jsx(i,{height:18,width:60})]},n))}):r.length===0?e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx("div",{className:"text-4xl",children:"ðŸ“‹"}),e.jsx("p",{className:"text-muted-foreground",children:c("recentTransactions.emptyDescription")}),e.jsx(k,{onClick:()=>o("/transactions"),size:x?"sm":"default",children:c("recentTransactions.addFirst")})]}):e.jsxs("div",{className:"space-y-3",children:[r.map(s=>e.jsxs("div",{className:"flex items-center justify-between rounded-xl border border-border bg-card/70 p-3 shadow-sm",onClick:()=>o("/transactions"),children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`flex h-10 w-10 items-center justify-center rounded-full ${s.type==="income"?"bg-emerald-500/10":"bg-rose-500/10"}`,children:F(s.type)}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("div",{className:"font-semibold text-sm",children:s.description}),e.jsxs("div",{className:"text-xs text-muted-foreground flex items-center gap-1",children:[e.jsx("span",{children:w(s.date)}),s.category&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"â€¢"}),e.jsx("span",{className:"capitalize",children:p(s.category)})]})]})]})]}),e.jsxs("div",{className:`text-sm font-semibold ${s.type==="income"?"text-emerald-600":"text-rose-600"}`,children:[s.type==="income"?"+":"-",j(s.amount)]})]},s.id)),e.jsx("div",{className:"flex justify-end",children:e.jsxs(k,{variant:"ghost",size:"sm",onClick:()=>o("/transactions"),className:"gap-1 text-primary",children:[c("recentTransactions.viewAll"),e.jsx(q,{className:"h-4 w-4"})]})})]})},G=()=>{const h=S(),{currentUser:g}=$(),{transactions:o,isDemo:x,canAddMoreTransactions:c,loading:r,fetchAllTransactions:w}=L(),[F,p]=m.useState(!1),[s,n]=m.useState([]),{t}=O();m.useEffect(()=>{(async()=>{if(x)n(o);else if(g){const C=await w();n(C)}})()},[x,o,g,w]);const u=m.useMemo(()=>{const a=localStorage.getItem("analytics-period");if(a)try{return JSON.parse(a)}catch{return{period:"monthly"}}return{period:"monthly"}},[]),{start:T,end:D}=J(u.period||"monthly",u.customRange),R=m.useMemo(()=>s.filter(a=>{const C=a.date;return C>=T&&C<=D}),[s,T,D]),d=m.useMemo(()=>r?null:R.length?W(R,T,D):{totalIncome:0,totalExpense:0,balance:0},[R,T,D,r]),I=m.useMemo(()=>[{key:"add-transaction",title:t("addTransaction"),subtitle:t("whatToRegister"),icon:e.jsx(A,{}),action:()=>p(!0),disabled:x&&!c},{key:"view-transactions",title:t("manageAll"),subtitle:t("yourTransactions"),icon:e.jsx(Q,{}),action:()=>h("/transactions")},{key:"view-analytics",title:t("navbar.analytics"),subtitle:t("landing.mainFeatures"),icon:e.jsx(U,{}),action:()=>h("/analytics")}],[x,c,h,t]);return e.jsxs("div",{className:"page-shell",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between rounded-2xl border border-border bg-card/70 p-5",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx("p",{className:"text-xs uppercase tracking-wide text-muted-foreground",children:"Soldi Sotto"}),e.jsxs("h2",{className:"text-3xl font-bold flex items-center gap-2",children:["ðŸ‘‹"," ",t("welcome")]}),e.jsx("p",{className:"text-sm text-muted-foreground max-w-2xl",children:t("motivationalQuote")})]}),e.jsxs("div",{className:"flex flex-wrap gap-2 md:gap-3",children:[e.jsxs(k,{variant:"outline",size:"lg",onClick:()=>h("/analytics"),className:"gap-2 px-4",children:[e.jsx(_,{className:"h-4 w-4"}),t("navbar.analytics")]}),e.jsxs(k,{size:"lg",onClick:()=>p(!0),disabled:x&&!c,className:"gap-2 px-4",children:[e.jsx(A,{className:"h-4 w-4"})," ",t("addTransaction")]})]})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[e.jsxs(f,{className:"glass",children:[e.jsxs(N,{children:[e.jsx(v,{children:t("financialOverview.balance")}),e.jsx(y,{children:t("financialOverview.totalTransactions")})]}),e.jsx(b,{children:r||!d?e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{height:36,width:"60%"}),e.jsx(i,{height:20,width:"40%"}),e.jsx(i,{height:20,width:"40%"})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-3xl font-bold text-primary",children:j(d.balance||0)}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[t("financialOverview.totalIncome"),": ",j(d.totalIncome||0)]}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[t("financialOverview.totalExpense"),": ",j(d.totalExpense||0)]})]})})]}),e.jsxs(f,{className:"glass",children:[e.jsxs(N,{children:[e.jsx(v,{children:t("financialOverview.totalIncome")}),e.jsx(y,{children:t(`periods.${u.period}`)})]}),e.jsx(b,{children:r||!d?e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{height:36,width:"50%"}),e.jsx(i,{height:20,width:"30%"})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-3xl font-bold text-emerald-600",children:j(d.totalIncome||0)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t("recentTransactions.title")})]})})]}),e.jsxs(f,{className:"glass",children:[e.jsxs(N,{children:[e.jsx(v,{children:t("financialOverview.totalExpense")}),e.jsx(y,{children:t(`periods.${u.period}`)})]}),e.jsx(b,{children:r||!d?e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{height:36,width:"50%"}),e.jsx(i,{height:20,width:"30%"})]}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-3xl font-bold text-rose-600",children:j(d.totalExpense||0)}),e.jsx("p",{className:"text-sm text-muted-foreground",children:t("recentTransactions.title")})]})})]})]}),e.jsxs("div",{className:"grid gap-4 lg:grid-cols-3",children:[e.jsxs(f,{className:"lg:col-span-2 glass",children:[e.jsxs(N,{children:[e.jsx(v,{children:t("quickActions")}),e.jsx(y,{children:t("whatToRegister")})]}),e.jsx(b,{className:"grid gap-3 md:grid-cols-3",children:I.map(a=>e.jsxs("button",{onClick:()=>!a.disabled&&a.action(),className:`flex items-center gap-3 rounded-xl border border-border bg-card/80 p-4 text-left shadow-sm transition hover:-translate-y-1 hover:shadow-lg ${a.disabled?"opacity-60 cursor-not-allowed":""}`,children:[e.jsx("span",{className:"flex h-10 w-10 items-center justify-center rounded-full bg-primary/10 text-primary",children:a.icon}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold",children:a.title}),e.jsx("div",{className:"text-xs text-muted-foreground",children:a.subtitle})]})]},a.key))})]}),e.jsxs(f,{className:"glass",children:[e.jsxs(N,{children:[e.jsx(v,{children:t("recentTransactions.title")}),e.jsx(y,{children:t("recentTransactions.viewAll")})]}),e.jsx(b,{children:e.jsx(E,{transactions:o,loading:r})})]})]}),e.jsx(H,{show:F,onClose:()=>p(!1),transaction:null})]})},se=B.memo(G);export{se as default};
