import{r as o,d as S,s as C,e as F,j as e,m as i,B as x,t as R,v as T,w as A,x as M,y as I,g as U,L as P,z as D,A as W,C as f,D as j,E as v}from"./index-Bjk7Il94.js";import{A as q}from"./Alert-rTvYwIdw.js";import{F as r}from"./Form-DjiPExJX.js";import"./Col-Bo0QpJom.js";const O=()=>{const[n,N]=o.useState(""),[u,w]=o.useState(""),[l,k]=o.useState(!1),[d,c]=o.useState(!1),[p,m]=o.useState(""),g=S(),z=C(),b=F({maxWidth:768}),h=a=>a.includes("@")&&a.includes("."),E=async a=>{try{const t=await f(j(v,"usernames",a.toLowerCase()));if(t.exists()){const s=t.data().uid,y=await f(j(v,"users",s));if(y.exists())return y.data().email}return null}catch(t){return console.error("Errore nella ricerca username:",t),null}},L=async a=>{a.preventDefault(),c(!0),m("");try{let t=n;if(!h(n)){const s=await E(n);if(!s){m("Username non trovato"),c(!1);return}t=s}await D(W,t,u),z.success("Accesso effettuato con successo!"),g("/dashboard")}catch(t){console.error("Errore durante il login:",t);let s="Errore durante l'accesso";switch(t.code){case"auth/user-not-found":s=h(n)?"Email non trovata":"Username non trovato";break;case"auth/wrong-password":s="Password non corretta";break;case"auth/invalid-email":s="Email non valida";break;case"auth/too-many-requests":s="Troppi tentativi. Riprova più tardi";break;case"auth/invalid-credential":s="Credenziali non valide";break;default:s=t.message}m(s)}finally{c(!1)}};return e.jsx("div",{className:"min-vh-100 d-flex align-items-center justify-content-center",style:{background:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)",padding:b?"20px":"40px",position:"relative"},children:e.jsxs(i.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},style:{width:"100%",maxWidth:"440px",position:"relative"},children:[e.jsx(i.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.1},className:"mb-4",children:e.jsxs(x,{variant:"link",onClick:()=>g("/"),className:"text-decoration-none p-0 d-flex align-items-center gap-2 text-white",style:{fontSize:"14px",background:"rgba(255, 255, 255, 0.15)",borderRadius:"12px",padding:"8px 16px",border:"1px solid rgba(255, 255, 255, 0.2)",transition:"all 0.2s ease"},onMouseEnter:a=>{a.currentTarget.style.background="rgba(255, 255, 255, 0.25)"},onMouseLeave:a=>{a.currentTarget.style.background="rgba(255, 255, 255, 0.15)"},children:[e.jsx(R,{size:16}),"Torna alla Home"]})}),e.jsxs("div",{style:{background:"rgba(255, 255, 255, 0.95)",borderRadius:"24px",border:"1px solid rgba(255, 255, 255, 0.3)",boxShadow:"0 20px 40px rgba(0, 0, 0, 0.1)",padding:b?"24px":"32px",position:"relative",willChange:"transform"},children:[e.jsx(i.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"text-center mb-4",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center gap-3 mb-3",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center",style:{width:"52px",height:"52px",background:"linear-gradient(135deg, #667eea, #764ba2)",color:"white",fontSize:"24px"},children:"💰"}),e.jsxs("div",{className:"text-start",children:[e.jsx("h2",{className:"fw-bold text-dark mb-0",children:"Bentornato!"}),e.jsx("small",{className:"text-muted",children:"Accedi con il tuo account"})]})]})}),p&&e.jsx(i.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"mb-4",children:e.jsx(q,{variant:"danger",className:"border-0",style:{background:"rgba(239, 68, 68, 0.1)",borderRadius:"12px",border:"1px solid rgba(239, 68, 68, 0.2)",padding:"12px 16px"},children:e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("span",{children:"❌"}),e.jsx("span",{style:{fontSize:"14px"},children:p})]})})}),e.jsxs(r,{onSubmit:L,children:[e.jsx(i.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsxs(r.Group,{className:"mb-3",children:[e.jsx(r.Label,{className:"fw-semibold text-dark small mb-2",children:"Username o Email"}),e.jsxs("div",{className:"position-relative",children:[e.jsx(T,{className:"position-absolute top-50 translate-middle-y text-muted",style:{left:"14px",zIndex:10},size:16}),e.jsx(r.Control,{type:"text",placeholder:"username o email",value:n,onChange:a=>N(a.target.value),required:!0,className:"border-0",style:{paddingLeft:"44px",height:"48px",borderRadius:"12px",fontSize:"15px",background:"rgba(248, 249, 250, 0.8)",border:"1px solid rgba(0, 0, 0, 0.08)",fontWeight:"500"}})]}),e.jsx(r.Text,{className:"text-muted small",children:"Inserisci la email di registrazione per accedere"})]})}),e.jsx(i.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.4},children:e.jsxs(r.Group,{className:"mb-4",children:[e.jsx(r.Label,{className:"fw-semibold text-dark small mb-2",children:"Password"}),e.jsxs("div",{className:"position-relative",children:[e.jsx(A,{className:"position-absolute top-50 translate-middle-y text-muted",style:{left:"14px",zIndex:10},size:16}),e.jsx(r.Control,{type:l?"text":"password",placeholder:"inserisci la tua password",value:u,onChange:a=>w(a.target.value),required:!0,className:"border-0",style:{paddingLeft:"44px",paddingRight:"44px",height:"48px",borderRadius:"12px",fontSize:"15px",background:"rgba(248, 249, 250, 0.8)",border:"1px solid rgba(0, 0, 0, 0.08)",fontWeight:"500"}}),e.jsx(x,{variant:"link",type:"button",onClick:()=>k(!l),className:"position-absolute top-50 translate-middle-y border-0 text-muted p-0",style:{right:"14px",zIndex:10},children:l?e.jsx(M,{size:16}):e.jsx(I,{size:16})})]})]})}),e.jsx(i.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.5},children:e.jsx(x,{type:"submit",disabled:d,className:"w-100 border-0 fw-semibold mb-4",style:{height:"50px",borderRadius:"12px",background:"linear-gradient(135deg, #667eea, #764ba2)",fontSize:"16px",transition:"transform 0.2s ease"},onMouseEnter:a=>{d||(a.currentTarget.style.transform="translateY(-1px)")},onMouseLeave:a=>{a.currentTarget.style.transform="translateY(0)"},children:d?e.jsxs("div",{className:"d-flex align-items-center justify-content-center",children:[e.jsx("div",{className:"spinner-border spinner-border-sm me-2",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),"Accesso in corso..."]}):e.jsxs("div",{className:"d-flex align-items-center justify-content-center gap-2",children:[e.jsx(U,{size:18}),"Accedi"]})})})]}),e.jsx(i.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.6},className:"text-center",children:e.jsxs("p",{className:"text-muted mb-0 small",children:["Non hai un account?"," ",e.jsx(P,{to:"/register",className:"text-decoration-none fw-semibold",style:{color:"#667eea",transition:"color 0.2s ease"},onMouseEnter:a=>{a.currentTarget.style.color="#764ba2"},onMouseLeave:a=>{a.currentTarget.style.color="#667eea"},children:"Registrati ora"})]})})]})]})})};export{O as default};
