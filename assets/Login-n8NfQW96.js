import{r as i,b as z,z as R,d as C,e as I,j as e,m as l,f as u,aq as T,U as P,ar as A,as as H,at as M,ai as U,au as D,av as q,aw as B,p as y,q as j,s as w}from"./index-DhPDyLgL.js";import{A as O}from"./Alert-BqVq1Us6.js";import{F as o}from"./Form-DqIPrd7s.js";import"./hook-mgdtgGYD.js";import"./Col-BtPTxbzW.js";import"./useEventCallback-BQY3u4oO.js";const X=()=>{const[n,v]=i.useState(""),[p,N]=i.useState(""),[d,k]=i.useState(!1),[S,c]=i.useState(!1),[x,m]=i.useState(""),g=z(),E=R(),b=C({maxWidth:768}),{t:a}=I(),h=s=>s.includes("@")&&s.includes("."),L=async s=>{try{const t=await y(j(w,"usernames",s.toLowerCase()));if(t.exists()){const r=t.data().uid,f=await y(j(w,"users",r));if(f.exists())return f.data().email}return null}catch(t){return console.error("Errore nella ricerca username:",t),null}},F=async s=>{s.preventDefault(),c(!0),m("");try{let t=n;if(!h(n)){const r=await L(n);if(!r){m("Username non trovato"),c(!1);return}t=r}await q(B,t,p),E.success("Accesso effettuato con successo!"),g("/dashboard")}catch(t){console.error("Errore durante il login:",t);let r=a("errors.loginError");switch(t.code){case"auth/user-not-found":r=h(n)?a("errors.emailNotFound"):a("errors.usernameNotFound");break;case"auth/wrong-password":r=a("errors.wrongPassword");break;case"auth/invalid-email":r=a("errors.invalidEmail");break;case"auth/too-many-requests":r=a("errors.tooManyRequests");break;case"auth/invalid-credential":r=a("errors.invalidCredentials");break;default:r=t.message}m(r)}finally{c(!1)}};return e.jsx("div",{className:"min-vh-100 d-flex align-items-center justify-content-center",style:{background:"var(--background-primary, #f8fafc)",padding:b?"8px":"24px",position:"relative"},children:e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.4},style:{width:"100%",maxWidth:"370px",position:"relative"},children:[e.jsx(l.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},transition:{delay:.1},className:"mb-3",children:e.jsxs(u,{variant:"link",onClick:()=>g("/"),className:"text-decoration-none p-0 d-flex align-items-center gap-2",style:{fontSize:"13px",background:"rgba(255,255,255,0.18)",borderRadius:"10px",padding:"6px 14px",border:"1px solid rgba(0,0,0,0.07)",color:"#222",backdropFilter:"blur(8px)",transition:"all 0.2s ease"},onMouseEnter:s=>{s.currentTarget.style.background="rgba(0,0,0,0.08)"},onMouseLeave:s=>{s.currentTarget.style.background="rgba(255,255,255,0.18)"},children:[e.jsx(T,{size:15}),a("login.backToHome")]})}),e.jsxs("div",{style:{background:"rgba(255,255,255,0.72)",borderRadius:"18px",border:"1px solid rgba(0,0,0,0.06)",boxShadow:"0 2px 16px rgba(0,0,0,0.06)",padding:b?"16px":"22px",position:"relative",backdropFilter:"blur(12px)",willChange:"transform"},children:[e.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"text-center mb-3",children:e.jsxs("div",{className:"d-flex align-items-center justify-content-center gap-2 mb-2",children:[e.jsx("div",{className:"rounded-circle d-flex align-items-center justify-content-center",style:{width:"38px",height:"38px",background:"rgba(13,110,253,0.13)",color:"#0d6efd",fontSize:"18px"},children:"ðŸ’°"}),e.jsxs("div",{className:"text-start",children:[e.jsx("h2",{className:"fw-semibold text-dark mb-0",style:{fontSize:"1.25rem"},children:a("login.title")}),e.jsx("small",{className:"text-muted",style:{fontSize:"0.95rem"},children:a("login.subtitle")})]})]})}),x&&e.jsx(l.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"mb-3",children:e.jsx(O,{variant:"danger",className:"border-0",style:{background:"rgba(239, 68, 68, 0.08)",borderRadius:"10px",border:"1px solid rgba(239, 68, 68, 0.13)",padding:"8px 12px"},children:e.jsxs("div",{className:"d-flex align-items-center gap-2",children:[e.jsx("span",{children:"âŒ"}),e.jsx("span",{style:{fontSize:"14px"},children:x})]})})}),e.jsxs(o,{onSubmit:F,autoComplete:"on",children:[e.jsxs(o.Group,{className:"mb-3",controlId:"loginInput",children:[e.jsx(o.Label,{className:"fw-semibold small",children:a("login.usernameOrEmail")}),e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text bg-transparent border-end-0",style:{padding:"0.5rem 0.7rem",fontSize:"1.1rem",color:document.documentElement.classList.contains("dark-theme")?"#fff":"#222"},children:e.jsx(P,{})}),e.jsx(o.Control,{type:"text",placeholder:a("login.usernameOrEmailPlaceholder"),value:n,onChange:s=>v(s.target.value),style:{background:"rgba(255,255,255,0.7)",border:"1px solid #e5e7eb",borderRadius:"10px",borderTopLeftRadius:0,borderBottomLeftRadius:0,fontSize:"1rem",minHeight:"44px",padding:"0.5rem 1rem",color:"#222",boxShadow:"none"},autoComplete:"username"})]}),e.jsx(o.Text,{className:"text-muted small",children:a("login.usernameOrEmailHelp")})]}),e.jsxs(o.Group,{className:"mb-3",controlId:"password",children:[e.jsx(o.Label,{className:"fw-semibold small",children:a("login.password")}),e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text bg-transparent border-end-0",style:{padding:"0.5rem 0.7rem",fontSize:"1.1rem",color:document.documentElement.classList.contains("dark-theme")?"#fff":"#222"},children:e.jsx(A,{})}),e.jsx(o.Control,{type:d?"text":"password",placeholder:a("login.passwordPlaceholder"),value:p,onChange:s=>N(s.target.value),style:{background:"rgba(255,255,255,0.7)",border:"1px solid #e5e7eb",borderRadius:"10px",borderTopLeftRadius:0,borderBottomLeftRadius:0,fontSize:"1rem",minHeight:"44px",padding:"0.5rem 1rem",color:"#222",boxShadow:"none"},autoComplete:"current-password"}),e.jsx(u,{variant:"outline-secondary",onClick:()=>k(!d),style:{border:"none",background:"transparent",color:"#888",fontSize:"1.1rem",borderRadius:"0 10px 10px 0",minHeight:"44px"},tabIndex:-1,children:d?e.jsx(H,{}):e.jsx(M,{})})]})]}),e.jsxs(u,{type:"submit",className:"w-100 fw-semibold mt-2",style:{borderRadius:"10px",minHeight:"44px",fontSize:"1.08rem",background:"rgba(13,110,253,0.93)",color:"#fff",border:"none",boxShadow:"0 1px 6px rgba(13,110,253,0.07)",transition:"all 0.2s"},disabled:S,children:[e.jsx(U,{className:"me-2"})," ",a("login.loginButton")]})]}),e.jsxs("div",{className:"text-center mt-3",children:[e.jsx("span",{className:"text-muted small",children:a("login.noAccount")})," ",e.jsx(D,{to:"/register",className:"fw-semibold",style:{color:"#0d6efd",textDecoration:"none"},children:a("login.registerNow")})]})]})]})})};export{X as default};
